create table Director(
    director_id int generated by default as identity primary key,
    name varchar(100) not null unique,
    age int check ( age > 18 ) not null
);

create table Movie (
    movie_id int generated by default as identity primary key ,
    director_id int not null references Director(director_id),
    name varchar(200) not null ,
    year_of_production int check ( year_of_production > 1900 )
);

insert into Director (name, age) values ('Quentin Tarantino', 57),
                                        ('Martin Scorsese', 78),
                                        ('Guy Ritchie', 52),
                                        ('Woody Allen', 85),
                                        ('David Lynch', 74),
                                        ('Christopher Nolan', 50);

insert into movie(director_id, name, year_of_production) values (1, 'Reservoir Dogs', 1992),
                                                                (1, 'Pulp Fiction', 1994),
                                                                (1, 'The Hateful Eight', 2015),
                                                                (1, 'Once Upon time in HollyWood', 2019),
                                                                (2, 'Taxi driver', 1976),
                                                                (2, 'Good Fellas', 1990),
                                                                (2, 'The wolf of Wall street', 2013),
                                                                (3, 'Lock, stock and two smoking Barrels', 1998),
                                                                (3, 'Snatch', 2000),
                                                                (4, 'Midnight in Paris', 2011),
                                                                (6, 'Inception', 2010);

/*Inner Join  */
select * from director join movie on director.director_id = movie.director_id;